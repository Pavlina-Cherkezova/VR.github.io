<!DOCTYPE html>

<html>

<head>
    <title>E1113: Кубична текстура</title>
    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

    <script src="three.min.js"></script>
    <script src="OrbitControls.js"></script>
    <script src="WebGL.js"></script>
    <script src="vax.js"></script>
</head>

<body>
    <script>
        vaxInit();
        camera.position.set(0, 0, 20);
        camera.lookAt(new THREE.Vector3(0, 0, 0));
        camera.fov = 100;
        onWindowResize();
        window.addEventListener("deviceorientation", deviceOrientation, true);

        // var controls = new THREE.OrbitControls(camera, renderer.domElement);
        // controls.enableZoom = false;
        // controls.enablePan = false;
        // controls.enableDamping = true;
        // controls.minPolarAngle = 0.1;
        // controls.maxPolarAngle = Math.PI - 0.1;
        // controls.dampingFactor = 0.1;

        function deviceOrientation(event) {
            // var alpha = THREE.Math.degToRad(event.alpha),
            //     beta = THREE.Math.degToRad(event.beta);
            //     gamma = THREE.Math.degToRad(event.gamma);

            // camera.rotation.set( beta, alpha, -gamma, 'YZX');

            // взимаме ъглите
            var alpha = event.alpha,
                gamma = event.gamma;

            if (alpha === null) return;

            // поправяме ги, за да ни е удобно
            if (gamma >= 0)
                gamma = 90 - gamma;
            else {
                alpha = alpha + 180;
                gamma = -90 - gamma;
            }

            // правим ги на радиани
            alpha = THREE.Math.degToRad(alpha);
            gamma = THREE.Math.degToRad(gamma);

            // въртим камерата
            camera.rotation.set(gamma, alpha, 0, 'YZX')
        }

        scene.background = new THREE.CubeTextureLoader().load([
            'green-gridC.jpg', 'green-gridC.jpg',
            'green-gridC.jpg', 'green-gridC.jpg',
            'green-gridC.jpg', 'green-gridC.jpg']);

        var coneGeometry = new THREE.ConeBufferGeometry(7, 30, 100);
        for (let i = 0; i < 100; i++) {
            let cone = new THREE.Mesh(
                coneGeometry,
                new THREE.MeshStandardMaterial({ color: new THREE.Color(0.5 + Math.random(), 0.5 + Math.random(), 0.5 + Math.random()) })
            );
            cone.position.set(THREE.Math.randFloat(-250, 250), THREE.Math.randFloat(-250, 250), THREE.Math.randFloat(-250, 250));
            scene.add(cone);
        }


        function animate() {
            //controls.update();
        }

    </script>

</body>

</html>